@model IEnumerable<GTERP.Controllers.HR.EmployeeListController.EmpList>


    <style>

        .tbllist th:first-child, .tbllist tbody td:first-child {
            position: sticky !important;
            left: 0px;
            background-color: #f2f2f2e6;
            z-index: 1;
        }

        .tbllist tfoot td:first-child {
            position: sticky;
            left: 0px;
            z-index: 1;
        }


        .tbllist th:last-child, .tbllist tbody td:last-child {
            position: sticky !important;
            right: 0px;
            background-color: #f2f2f2e6;
            z-index: 1;
        }

        .tbllist tfoot td:last-child {
            position: sticky;
            right: 0px;
            z-index: 1;
        }
    </style>

    <div class="container-fluid">

        <div class="text-center">
            <div class="row">

                @*<div class="col">
                    @Html.ActionLink("Employee Creation", "Create", null, null, new { @class = "btn btn-outline-info btn-block", @id = "btnBack" })
                </div>*@
                <div class="col">

                </div>
                @*<div class="col-lg-7">

                </div>*@
            </div>
        </div>

        <div class="col-md-12 text-right">
            <fieldset class="py-2">
                <label class="pr-2"><input type="radio" name="RptType" value="PDF" checked="checked" /> PDF  </label>
                <label class="pr-2"><input type="radio" name="RptType" value="EXCEL" /> EXCEL  </label>
                <label class="pr-2"><input type="radio" name="RptType" value="WORD" /> WORD  </label>
            </fieldset>
        </div>

        <div class="card p-2 table-responsive">
            <table id="tbllist" class="table table-striped table-bordered table-sm tbllist  table-hover" cellspacing="0" width="100%">
                <thead class="text-nowrap">
                    <tr>
                        <th>
                            Emp. Code     @* empcode 1 *@
                        </th>
                        <th>
                            Emp. Name @* empname 2 *@
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNameB)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpSpouse)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpSpouseB)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.EmpFather)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpFatherB)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.EmpMother)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpMotherB)
                        </th>
                        <th>
                            House Type
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.ReligionName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.BloodName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.UnitName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DeptName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.ShiftName)
                        </th>
                        <th>
                            Present Address
                        </th>
                        <th>
                            Permanent Address
                        </th>
                        <th>
                            Education
                        </th>
                        <th>
                            Experience
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DesigName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.SectName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.SubSectName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DtBirth)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DtJoin)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DtIncrement)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DtConfirm)
                        </th>
                        <th>
                            PF Date
                        </th>
                        <th>
                            Employee Type
                        </th>
                        <th>
                            Gender
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.NID)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.FingerId)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpPhone1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpPhone2)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.IsInactive)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpPerZip)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpEmail)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpRemarks)
                        </th>
                        <th>
                            Grade
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeName1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeMobile1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeNID1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeRelation1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeAddress1)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeName2)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeMobile2)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeNID2)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeRelation2)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.EmpNomineeAddress2)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.IsAllowOT)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.DtLocalJoin)
                        </th>
                        <th>
                        </th>
                    </tr>
                </thead>

                <tbody class="text-nowrap" style="text-align:left;">

                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpCode)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNameB)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpSpouse)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpSpouseB)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpFather)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpFatherB)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpMother)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpMotherB)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.HouseType)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ReligionName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.BloodName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.UnitName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DeptName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ShiftName)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.PresentAddress)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.PermanentAddress)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.Educations)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Experiences)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DesigName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.SectName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.SubSectName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DtBirth)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DtJoin)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DtIncrement)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DtConfirm)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DtPf)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpTypeName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.GenderName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.NID)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.FingerId)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpPhone1)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpPhone2)
                            </td>

                            <td>
                                @if (item.IsInactive)
                                {
                                    <text>Yes</text>
                                }
                                else
                                {
                                    <text>No</text>
                                }

                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpPerZip)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpEmail)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpRemarks)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.GradeName)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeName1)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeMobile1)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeNID1)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeRelation1)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeAddress1)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeName2)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeMobile2)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeNID2)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeRelation2)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.EmpNomineeAddress2)
                            </td>


                            <td>
                                @if (item.IsAllowOT)
                                {
                                    <text>Yes</text>
                                }
                                else
                                {
                                    <text>No</text>
                                }
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.DtLocalJoin)
                            </td>
                            <td>
                                @*@Html.ActionLink("", "Print", new { Id = item.EmpId }, new { @class = "far fa-file-pdf btn btn-success btn-xs" })*@

                                <a href="@Url.Action("Print", "EmployeeList", new { Id = item.EmpId, type="excel" })"                                   
                                   target="_blank"
                                   class="far fa-file-pdf btn btn-success btn-xs">
                                </a>
                                @*@Url.Action("Print", "EmployeeList")/' + data.EmpId + '?type=pdf'*@
                            </td>
                        </tr>
                    }

                </tbody>


            </table>
            <br />
        </div>
    </div>
    @section Scripts{
        <script>
            $(document).ready(function () {
                $('#tbllist thead tr').clone(true).appendTo('#tbllist thead');
                $('#tbllist thead:last tr:eq(0) th').each(function (i) {
                    var title = $(this).text().trim();
                    $(this).html('<input type="text" class="form-control"   placeholder="' + title + '" />');

                    $('input', this).on('keyup change', function () {
                        if (table.column(i).search() !== this.value) {
                            table
                                .column(i)
                                .search(this.value)
                                .draw();
                        }
                    });
                 });

               var table =  $('#tbllist').DataTable({
                    dom: '<"dom_wrapper fh-fixedHeader"flB>tip',
                    //"sDom": "<'row'<'col-sm-12'<'form-group'<f>>>>tr<'row'<'col-sm-12'<'pull-left'i><'pull-right'p><'clearfix'>>>",
                    //buttons: [
                    //    'copy', 'csv', 'excel', 'pdf'
                    //],
                    buttons: {
                        dom: {
                            button: {
                                className: 'btn rounded-0'
                            }
                        },
                        buttons: [
                            //'copy', 'csv', 'excel', 'pdf'
                            //$(this).addClass("btn-group dt-buttons justify-content-center mb-3")
                            {
                                extend: 'colvis',
                                "columns": ':not(:last-child)',
                                text: '<i class="mdi mdi-view-column"></i>',
                                className: 'btn-info',
                                titleAttr: 'Show / hide columns',
                                //collectionLayout: 'fixed two-column'

                            },
                            {
                                extend: 'excel',
                                text: '<i class="mdi mdi-file-excel"></i>',
                                className: 'btn-success',
                                titleAttr: 'Export to excel',
                                exportOptions: {
                                    columns: ':visible',
                                    rows: ':visible'
                                }
                            }

                        ]
                    },
                    "searching": true,
                    "ordering": true,
                    "info": true,
                    "iDisplayLength": 15,
                    "lengthMenu": [[5, 15, 20, 50, -1], [5, 15, 20, 50, "All"]],
                    "scrollX": true,
                    "scrollY": "60vh",
                    language: {
                        sLengthMenu: "_MENU_",
                        search: "",
                        searchPlaceholder: "Search..."
                    },
                    dom: 'Blfrtip'
                });
            });

                                //$(".search_input").addClass('form-control input-lg col-xs-12');

        </script>
    }



